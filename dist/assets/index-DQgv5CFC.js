(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const y of n.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&a(y)}).observe(document,{childList:!0,subtree:!0});function l(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(t){if(t.ep)return;t.ep=!0;const n=l(t);fetch(t.href,n)}})();const r=document.getElementById("sourcePath"),m=document.getElementById("destPath"),A=document.getElementById("quality"),z=document.getElementById("saveBtn"),v=document.getElementById("startBtn"),h=document.getElementById("stopBtn"),Q=document.getElementById("logArea"),c=document.getElementById("statusIndicator"),U=document.getElementById("toggleAdvanced"),W=document.getElementById("toggleIcon"),V=document.getElementById("advancedSettings"),f=document.getElementById("pdfSettings"),E=document.getElementById("compatibilityLevel"),d=document.getElementById("colorImageResolution"),u=document.getElementById("grayImageResolution"),i=document.getElementById("monoImageResolution"),O=document.getElementById("colorImageFilter"),G=document.getElementById("grayImageFilter"),B=document.getElementById("colorImageDownsampleType"),w=document.getElementById("grayImageDownsampleType"),T=document.getElementById("monoImageDownsampleType"),M=document.getElementById("subsetFonts"),q=document.getElementById("compressFonts"),N=document.getElementById("embedAllFonts"),j=document.getElementById("downsampleColorImages"),$=document.getElementById("downsampleGrayImages"),H=document.getElementById("downsampleMonoImages"),J=document.getElementById("autoFilterColorImages"),K=document.getElementById("autoFilterGrayImages"),g=document.getElementById("colorImageDownsampleThreshold"),p=document.getElementById("grayImageDownsampleThreshold"),I=document.getElementById("monoImageDownsampleThreshold"),F=document.getElementById("detectDuplicateImages"),D=document.getElementById("compressPages"),C=document.getElementById("colorResValue"),b=document.getElementById("grayResValue"),L=document.getElementById("monoResValue"),k=document.getElementById("colorThresholdValue"),x=document.getElementById("grayThresholdValue"),R=document.getElementById("monoThresholdValue"),X=document.getElementById("browseSource"),Y=document.getElementById("browseDest");let P=!1;X.addEventListener("click",()=>{const e=prompt("Cole o caminho da pasta de origem:",r.value);e&&(r.value=e)});Y.addEventListener("click",()=>{const e=prompt("Cole o caminho da pasta de destino:",m.value);e&&(m.value=e)});U.addEventListener("click",()=>{const e=V.style.display!=="none";V.style.display=e?"none":"block",W.classList.toggle("rotated")});d.addEventListener("input",e=>{C.textContent=e.target.value});u.addEventListener("input",e=>{b.textContent=e.target.value});i.addEventListener("input",e=>{L.textContent=e.target.value});g.addEventListener("input",e=>{k.textContent=parseFloat(e.target.value).toFixed(1)});p.addEventListener("input",e=>{x.textContent=parseFloat(e.target.value).toFixed(1)});I.addEventListener("input",e=>{R.textContent=parseFloat(e.target.value).toFixed(1)});document.getElementById("setDefaultBtn").addEventListener("click",()=>{f.value="/screen",E.value="1.4",d.value=115,u.value=115,i.value=115,C.textContent="115",b.textContent="115",L.textContent="115",B.value="/Bicubic",w.value="/Bicubic",T.value="/Bicubic",g.value=1,p.value=1,I.value=1,k.textContent="1.0",x.textContent="1.0",R.textContent="1.0",F.checked=!0,D.checked=!0,alert("✅ Configurações restauradas para o padrão (/screen + 115 DPI + Threshold 1.0)")});async function s(e,o="GET",l=null){const a={method:o,headers:{"Content-Type":"application/json"}};l&&(a.body=JSON.stringify(l));try{return await(await fetch(e,a)).json()}catch(t){return console.error("API Error:",t),null}}async function Z(){const e=await s("/api/config");e&&(r.value=e.sourcePath||"",m.value=e.destPath||"",A.value=e.quality||"/ebook",f.value=e.pdfSettings||"/printer",E.value=e.compatibilityLevel||"1.4",d.value=e.colorImageResolution||115,u.value=e.grayImageResolution||115,i.value=e.monoImageResolution||115,C.textContent=e.colorImageResolution||115,b.textContent=e.grayImageResolution||115,L.textContent=e.monoImageResolution||115,O.value=e.colorImageFilter||"/DCTEncode",G.value=e.grayImageFilter||"/DCTEncode",B.value=e.colorImageDownsampleType||"/Bicubic",w.value=e.grayImageDownsampleType||"/Bicubic",T.value=e.monoImageDownsampleType||"/Bicubic",M.checked=e.subsetFonts!==!1,q.checked=e.compressFonts!==!1,N.checked=e.embedAllFonts===!0,j.checked=e.downsampleColorImages!==!1,$.checked=e.downsampleGrayImages!==!1,H.checked=e.downsampleMonoImages!==!1,J.checked=e.autoFilterColorImages===!0,K.checked=e.autoFilterGrayImages===!0,g.value=e.colorImageDownsampleThreshold||1,p.value=e.grayImageDownsampleThreshold||1,I.value=e.monoImageDownsampleThreshold||1,k.textContent=(e.colorImageDownsampleThreshold||1).toFixed(1),x.textContent=(e.grayImageDownsampleThreshold||1).toFixed(1),R.textContent=(e.monoImageDownsampleThreshold||1).toFixed(1),F.checked=e.detectDuplicateImages!==!1,D.checked=e.compressPages!==!1)}async function _(){const e=await s("/api/logs");e&&Array.isArray(e)&&(Q.innerHTML=e.map(o=>`
            <div class="log-entry">
                <span class="log-time">[${o.timestamp}]</span>
                <span class="log-msg type-${o.type}">${o.message}</span>
            </div>
        `).join(""))}z.addEventListener("click",async()=>{const e={sourcePath:r.value.trim(),destPath:m.value.trim(),quality:A.value,pdfSettings:f.value,compatibilityLevel:E.value,colorImageResolution:parseInt(d.value),grayImageResolution:parseInt(u.value),monoImageResolution:parseInt(i.value),colorImageFilter:O.value,grayImageFilter:G.value,colorImageDownsampleType:B.value,grayImageDownsampleType:w.value,monoImageDownsampleType:T.value,subsetFonts:M.checked,compressFonts:q.checked,embedAllFonts:N.checked,downsampleColorImages:j.checked,downsampleGrayImages:$.checked,downsampleMonoImages:H.checked,autoFilterColorImages:J.checked,autoFilterGrayImages:K.checked,colorImageDownsampleThreshold:parseFloat(g.value),grayImageDownsampleThreshold:parseFloat(p.value),monoImageDownsampleThreshold:parseFloat(I.value),detectDuplicateImages:F.checked,compressPages:D.checked},o=await s("/api/config","POST",e);o&&o.success});v.addEventListener("click",async()=>{const e=await s("/api/start","POST");e&&e.success&&(P=!0,S())});h.addEventListener("click",async()=>{const e=await s("/api/stop","POST");e&&e.success&&(P=!1,S())});function S(){P?(c.classList.add("status-active"),c.classList.remove("status-inactive"),v.disabled=!0,h.disabled=!1):(c.classList.add("status-inactive"),c.classList.remove("status-active"),v.disabled=!1,h.disabled=!0)}setInterval(_,2e3);Z();S();
