(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const p of n.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&a(p)}).observe(document,{childList:!0,subtree:!0});function l(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(t){if(t.ep)return;t.ep=!0;const n=l(t);fetch(t.href,n)}})();const S=document.getElementById("sourcePath"),V=document.getElementById("destPath"),A=document.getElementById("quality"),z=document.getElementById("saveBtn"),I=document.getElementById("startBtn"),y=document.getElementById("stopBtn"),Q=document.getElementById("logArea"),c=document.getElementById("statusIndicator"),U=document.getElementById("toggleAdvanced"),W=document.getElementById("toggleIcon"),P=document.getElementById("advancedSettings"),h=document.getElementById("pdfSettings"),v=document.getElementById("compatibilityLevel"),m=document.getElementById("colorImageResolution"),r=document.getElementById("grayImageResolution"),d=document.getElementById("monoImageResolution"),O=document.getElementById("colorImageFilter"),G=document.getElementById("grayImageFilter"),f=document.getElementById("colorImageDownsampleType"),E=document.getElementById("grayImageDownsampleType"),B=document.getElementById("monoImageDownsampleType"),M=document.getElementById("subsetFonts"),q=document.getElementById("compressFonts"),N=document.getElementById("embedAllFonts"),j=document.getElementById("downsampleColorImages"),$=document.getElementById("downsampleGrayImages"),H=document.getElementById("downsampleMonoImages"),J=document.getElementById("autoFilterColorImages"),K=document.getElementById("autoFilterGrayImages"),u=document.getElementById("colorImageDownsampleThreshold"),i=document.getElementById("grayImageDownsampleThreshold"),g=document.getElementById("monoImageDownsampleThreshold"),w=document.getElementById("detectDuplicateImages"),T=document.getElementById("compressPages"),F=document.getElementById("colorResValue"),D=document.getElementById("grayResValue"),C=document.getElementById("monoResValue"),b=document.getElementById("colorThresholdValue"),L=document.getElementById("grayThresholdValue"),k=document.getElementById("monoThresholdValue");let x=!1;U.addEventListener("click",()=>{const e=P.style.display!=="none";P.style.display=e?"none":"block",W.classList.toggle("rotated")});m.addEventListener("input",e=>{F.textContent=e.target.value});r.addEventListener("input",e=>{D.textContent=e.target.value});d.addEventListener("input",e=>{C.textContent=e.target.value});u.addEventListener("input",e=>{b.textContent=parseFloat(e.target.value).toFixed(1)});i.addEventListener("input",e=>{L.textContent=parseFloat(e.target.value).toFixed(1)});g.addEventListener("input",e=>{k.textContent=parseFloat(e.target.value).toFixed(1)});document.getElementById("setDefaultBtn").addEventListener("click",()=>{h.value="/screen",v.value="1.4",m.value=115,r.value=115,d.value=115,F.textContent="115",D.textContent="115",C.textContent="115",f.value="/Bicubic",E.value="/Bicubic",B.value="/Bicubic",u.value=1,i.value=1,g.value=1,b.textContent="1.0",L.textContent="1.0",k.textContent="1.0",w.checked=!0,T.checked=!0,alert("✅ Configurações restauradas para o padrão (/screen + 115 DPI + Threshold 1.0)")});async function s(e,o="GET",l=null){const a={method:o,headers:{"Content-Type":"application/json"}};l&&(a.body=JSON.stringify(l));try{return await(await fetch(e,a)).json()}catch(t){return console.error("API Error:",t),null}}async function X(){const e=await s("/api/config");e&&(S.value=e.sourcePath||"",V.value=e.destPath||"",A.value=e.quality||"/ebook",h.value=e.pdfSettings||"/printer",v.value=e.compatibilityLevel||"1.4",m.value=e.colorImageResolution||115,r.value=e.grayImageResolution||115,d.value=e.monoImageResolution||115,F.textContent=e.colorImageResolution||115,D.textContent=e.grayImageResolution||115,C.textContent=e.monoImageResolution||115,O.value=e.colorImageFilter||"/DCTEncode",G.value=e.grayImageFilter||"/DCTEncode",f.value=e.colorImageDownsampleType||"/Bicubic",E.value=e.grayImageDownsampleType||"/Bicubic",B.value=e.monoImageDownsampleType||"/Bicubic",M.checked=e.subsetFonts!==!1,q.checked=e.compressFonts!==!1,N.checked=e.embedAllFonts===!0,j.checked=e.downsampleColorImages!==!1,$.checked=e.downsampleGrayImages!==!1,H.checked=e.downsampleMonoImages!==!1,J.checked=e.autoFilterColorImages===!0,K.checked=e.autoFilterGrayImages===!0,u.value=e.colorImageDownsampleThreshold||1,i.value=e.grayImageDownsampleThreshold||1,g.value=e.monoImageDownsampleThreshold||1,b.textContent=(e.colorImageDownsampleThreshold||1).toFixed(1),L.textContent=(e.grayImageDownsampleThreshold||1).toFixed(1),k.textContent=(e.monoImageDownsampleThreshold||1).toFixed(1),w.checked=e.detectDuplicateImages!==!1,T.checked=e.compressPages!==!1)}async function Y(){const e=await s("/api/logs");e&&Array.isArray(e)&&(Q.innerHTML=e.map(o=>`
            <div class="log-entry">
                <span class="log-time">[${o.timestamp}]</span>
                <span class="log-msg type-${o.type}">${o.message}</span>
            </div>
        `).join(""))}z.addEventListener("click",async()=>{const e={sourcePath:S.value.trim(),destPath:V.value.trim(),quality:A.value,pdfSettings:h.value,compatibilityLevel:v.value,colorImageResolution:parseInt(m.value),grayImageResolution:parseInt(r.value),monoImageResolution:parseInt(d.value),colorImageFilter:O.value,grayImageFilter:G.value,colorImageDownsampleType:f.value,grayImageDownsampleType:E.value,monoImageDownsampleType:B.value,subsetFonts:M.checked,compressFonts:q.checked,embedAllFonts:N.checked,downsampleColorImages:j.checked,downsampleGrayImages:$.checked,downsampleMonoImages:H.checked,autoFilterColorImages:J.checked,autoFilterGrayImages:K.checked,colorImageDownsampleThreshold:parseFloat(u.value),grayImageDownsampleThreshold:parseFloat(i.value),monoImageDownsampleThreshold:parseFloat(g.value),detectDuplicateImages:w.checked,compressPages:T.checked},o=await s("/api/config","POST",e);o&&o.success});I.addEventListener("click",async()=>{const e=await s("/api/start","POST");e&&e.success&&(x=!0,R())});y.addEventListener("click",async()=>{const e=await s("/api/stop","POST");e&&e.success&&(x=!1,R())});function R(){x?(c.classList.add("status-active"),c.classList.remove("status-inactive"),I.disabled=!0,y.disabled=!1):(c.classList.add("status-inactive"),c.classList.remove("status-active"),I.disabled=!1,y.disabled=!0)}setInterval(Y,2e3);X();R();
